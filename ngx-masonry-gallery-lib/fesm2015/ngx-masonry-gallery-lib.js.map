{"version":3,"file":"ngx-masonry-gallery-lib.js.map","sources":["ng://ngx-masonry-gallery-lib/lib/utilities.ts","ng://ngx-masonry-gallery-lib/lib/masonry-gallery.component.ts","ng://ngx-masonry-gallery-lib/lib/masonry-gallery.module.ts","ng://ngx-masonry-gallery-lib/lib/masonry-gallery-models.ts"],"sourcesContent":["export class Utilities {\r\n    newGuid() {\r\n       return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n           // tslint:disable-next-line:no-bitwise triple-equals\r\n           const r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n           return v.toString(16);\r\n       });\r\n   }\r\n}\r\n\r\nexport let utilities = new Utilities();\r\n","import { AfterViewInit, Component, EventEmitter, Input, OnChanges, OnDestroy, Output, Renderer2 } from '@angular/core';\r\nimport * as masonry from 'masonry-layout';\r\n\r\nimport { MasonryGalleryImage } from './masonry-gallery-models';\r\nimport { utilities } from './utilities';\r\n\r\n@Component({\r\n    selector: 'ngx-masonry-gallery',\r\n    template: '<div [id]=\"galleryGuid\"></div>',\r\n    styles: ['.hidden { display: none; }']\r\n})\r\nexport class MasonryGalleryComponent implements AfterViewInit, OnDestroy, OnChanges {\r\n\r\n    @Input() images: MasonryGalleryImage[] = [];\r\n    @Input() columnWidth: number = 330;\r\n    @Input() gutter: number = 5;\r\n    @Input() imageClasses: string[] = [];\r\n\r\n    @Output() clickImage = new EventEmitter<MasonryGalleryImage>();\r\n\r\n    /**\r\n     * Unique gallery guid used for distinguishing between multiple galleries on page\r\n     */\r\n    public readonly galleryGuid: string = utilities.newGuid();\r\n    private readonly mansonryItemSelectorClass = 'grid-item';\r\n    private readonly hiddenClass: string = 'hidden';\r\n\r\n    private msnry?: any;\r\n    private grid?: any;\r\n\r\n    private viewReady: boolean = false;\r\n\r\n    constructor(\r\n        private renderer: Renderer2\r\n    ) {\r\n    }\r\n\r\n    ngOnChanges(): void {\r\n        if (this.viewReady) {\r\n            this.initMasonry();\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.msnry) {\r\n            this.msnry.destroy();\r\n        }\r\n    }\r\n\r\n    handleClick(image: MasonryGalleryImage): void {\r\n        this.clickImage.next(image);\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        this.viewReady = true;\r\n        this.initMasonry();\r\n    }\r\n\r\n    private initMasonry(): void {\r\n        this.grid = document.getElementById(this.galleryGuid);\r\n\r\n        if (!this.grid) {\r\n            throw Error(`Could not init mansory due to non existing elem with id '${this.galleryGuid}'`);\r\n        }\r\n\r\n        this.msnry = new masonry(this.grid, {\r\n            // options...\r\n            itemSelector: '.' + this.mansonryItemSelectorClass,\r\n            columnWidth: this.columnWidth,\r\n            gutter: this.gutter,\r\n        });\r\n\r\n        const imageclass = this.getImageClass();\r\n\r\n        // add images to mansonry layout\r\n        this.images.forEach(image => {\r\n            // generate unique image id\r\n            const imageId = this.getImageId();\r\n\r\n            // create element\r\n            const imageElem = this.renderer.createElement('img');\r\n            imageElem.setAttribute('id', imageId);\r\n            imageElem.setAttribute('alt', image.alt ? image.alt : 'no description');\r\n            imageElem.setAttribute('src', image.imageUrl);\r\n            // note - images are hidden by default and should be shown only after they are loaded\r\n            imageElem.setAttribute('style', `max-width: ${this.columnWidth}px; margin-bottom: ${this.gutter}px`);\r\n            imageElem.className = imageclass;\r\n            imageElem.addEventListener('load', () => {\r\n                this.handleImageLoad(imageId);\r\n            });\r\n            imageElem.addEventListener('click', () => {\r\n                this.handleClick(image);\r\n            });\r\n\r\n            // add to dom and mansory & refresh layout\r\n            this.grid.appendChild(imageElem);\r\n        });\r\n    }\r\n\r\n    private getImageClass(): string {\r\n        let className = this.hiddenClass + ' ' + this.mansonryItemSelectorClass;\r\n\r\n        if (this.imageClasses && this.imageClasses.length > 0) {\r\n            const customClass = this.imageClasses.join(' ');\r\n\r\n            className += ' ' + customClass;\r\n        }\r\n\r\n        return className;\r\n    }\r\n\r\n    private getImageId(): string {\r\n        return this.galleryGuid + `_` + utilities.newGuid();\r\n    }\r\n\r\n    private handleImageLoad(imageId: string): void {\r\n        // find loaded image\r\n        const image = document.getElementById(imageId);\r\n\r\n        if (!image) {\r\n            return;\r\n        }\r\n\r\n        // unhide image\r\n        image.classList.remove(this.hiddenClass);\r\n\r\n        // append image to masonry\r\n        this.msnry.appended(image);\r\n    }\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { MasonryGalleryComponent } from './masonry-gallery.component';\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule\r\n    ],\r\n    declarations: [\r\n        MasonryGalleryComponent,\r\n    ],\r\n    exports: [\r\n        MasonryGalleryComponent,\r\n    ],\r\n})\r\nexport class MasonryGalleryModule { }\r\n","export class MasonryGalleryImage {\r\n\r\n    /**\r\n     * Url of the image\r\n     */\r\n    public imageUrl: string;\r\n\r\n    public alt?: string;\r\n\r\n    constructor(options: {\r\n        // required\r\n        imageUrl: string,\r\n\r\n        // optional\r\n        alt?: string,\r\n    }) {\r\n        Object.assign(this, options);\r\n    }\r\n}\r\n"],"names":[],"mappings":"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"}
